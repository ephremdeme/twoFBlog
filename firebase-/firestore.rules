rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /// FUNCTIONS START ///

    // get user role type
    function getUserRoleType(uid) {
    	return get(/databases/$(database)/documents/users/$(uid)).data.role == "ADMIN";
    }

    // get req user uid
    function getUserId() {
      return request.auth.uid
    }

    //Checks if user is signed in
    function isSignedIn() {
      return getUserId(getUserId()) != null;
    }

    //Check if user is super admin
    function isAdmin() {
      return getUserRoleType(getUserId()) == 'ADMIN';
    }

    //Check if user is blogger
    function isBlogger() {
      return getUserRoleType(getUserId()) == 'BLOGGER';
    }

    //Check if user is customer service
    function isCustomerService() {
      return getUserRoleType(getUserId()) == 'CUSTOMER_SERVICE';
    }

    //Check if user is user
    function isUser() {
      return getUserRoleType(getUserId()) == 'USER';
    }

    //Check if user is gust
    function isGuest() {
      return getUserRoleType(getUserId()) == 'GUEST';
    }

    //Check if user is shope admin
    function isShopeAdmin() {
      return getUserRoleType(getUserId()) == 'SHOPE_ADMIN';
    }

    //Check if user is seller
    function isSeller() {
      return getUserRoleType(getUserId()) == 'SELLER';
    }

    //Check if user is editor
    function idEditor() {
      return getUserRoleType(getUserId()) == 'EDITOR';
    }

    /// FUNCTIONS END ///


    /// RULES START ///
    
    match /{document=**} {
      // allow read, write: if request.auth.uid == null;
      allow read, write: if true;
    }
    
    match /blogs/{blog}{
    	allow read, write: if true;
    }

    match /products/{product=**} {
    	allow read, write: if isSignedIn() == true;
    }

  }
}